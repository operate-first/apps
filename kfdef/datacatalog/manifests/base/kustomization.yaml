---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: ABC

resources:
  - ./hue
  - ./thriftserver

commonLabels:
  opendatahub.io/component: "true"
  component.opendatahub.io/name: datacatalog

configMapGenerator:
  - name: datacatalog-config
    envs:
      - params.env

generatorOptions:
  disableNameSuffixHash: true

vars:
  - name: namespace
    objref:
      kind: Service
      apiVersion: v1
      name: hue
    fieldref:
      fieldpath: metadata.namespace
  - name: storage_class
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.storage_class
  - name: spark_url
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.spark_url
  - name: spark_max_cores
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.spark_max_cores
  - name: spark_executor_memory
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.spark_executor_memory
  - name: spark_driver_memory
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.spark_driver_memory
  - name: s3_endpoint
    objref:
      kind: ConfigMap
      apiVersion: v1
      name: datacatalog-config
    fieldref:
      fieldpath: data.s3_endpoint

configurations:
  - configurations.yaml

images:
  - name: hue
    newName: shgriffi/hue
    newTag: test
  - name: mysql
    newName: openshift/mysql
    newTag: "5.7"
  - name: mysqld-exporter
    newName: prom/mysqld-exporter
  - name: spark-cluster-image
    newName: quay.io/opendatahub/spark-cluster-image
    newTag: spark24
  - name: postgresql
    newName: openshift/postgresql
    newTag: "9.6"
  - name: postgres-exporter
    newName: docker.io/wrouesnel/postgres_exporter
